<div class="page page-table" data-ng-controller="blocksCtrl">
    <div class="row">
        <div class="col-md-6">
            <ol class="breadcrumb">
                <li><a href="#/"><span data-translate="Home"></span></a></li>
                <li><a href="#/blocks/"><span data-translate="Blocks"></span></a></li>
                <li class="active"><a href="#/blocks/{{data.block_num}}/"><span data-translate="Block number"></span>: {{data.block_num | number}}</a></li>
            </ol>
        </div>
        <div class="col-md-6">
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <a href="#/blocks/{{data.prev}}/">
                <i class="fas fa-angle-double-left"></i>
                <span data-translate="Block"></span>
                {{data.prev | number}}
            </a>
        </div>
        <div class="col-md-6" align="right">
            <a href="#/blocks/{{data.next}}/"><span data-translate="Block"></span> {{data.next | number}} <i class="fas fa-angle-double-right"></i> </a>
        </div>
    </div>
    <br>

    <div class="panel panel-default">
        <div class="panel-heading"> <span data-translate="Block"></span>: <strong>{{data.block_num | number}}</strong></div>
        <ul class="list-group">
            <li class="list-group-item">
                <span class="badge" style="background-color: #FFFFFF; color: #000000">{{data.previous}}</span>
                <span data-translate="Previous"></span>
            </li>
            <li class="list-group-item">
                <span class="badge" style="background-color: #FFFFFF; color: #000000">{{data.timestamp}}</span>
                <span data-translate="Date and time"></span>
            </li>
            <li class="list-group-item">
                <span class="badge" style="background-color: #FFFFFF; color: #000000">{{data.transaction_merkle_root}}</span>
                <span data-translate="Merkle Root"></span>
            </li>
            <li class="list-group-item">
                <span class="badge" style="background-color: #FFFFFF; color: #000000"><a href='#/witness/{{data.witness}}/'>{{data.witness}}</a></span>
                <span data-translate="Witness"></span>
            </li>
            <li class="list-group-item">
                <span class="badge" style="background-color: #FFFFFF; color: #000000">{{data.witness_signature}}</span>
                <span data-translate="Witness signature"></span>

            </li>
            <li class="list-group-item">
                <span class="badge" style="background-color: #FFFFFF; color: #000000">{{data.transactions_count}}</span>
                <span data-translate="Transactions in block"></span>
            </li>
            <li class="list-group-item">
                <span class="badge" style="background-color: #FFFFFF; color: #000000">{{data.operations_count}}</span>
                <span data-translate="Operations in block"></span>
            </li>
        </ul>
    </div>

    <div class="checkbox" style="margin-bottom: 20px;">
        <label>
            <input type="checkbox" id="blankCheckbox" ng-model="showRawData"> <span data-translate="Show transactions raw data"></span>
        </label>
    </div>

    <div class="row" ng-repeat="(trxId, transaction) in transactions" ng-show="!showRawData">
        <div class="col-md-8">
            <div class="panel panel-default">
                <div class="panel-heading"> <strong><span data-translate="Transaction"></span> {{$index + 1}}:</strong> <a href="#/txs/{{trxId}}">{{trxId}}</a></div>

                <div class="panel-body table-responsive">
                    <table class="table">
                        <thead>
                        <tr>
                            <th><span data-translate="Operation"></span></th>
                            <th><span data-translate="ID"></span></th>
                            <th><span data-translate="Type"></span></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-if="transaction.operations === undefined">
                            <td>
                                <loading></loading>
                            </td>
                        </tr>
                        <tr ng-if="transaction.operations === 'error'">
                            <td>
                                <loading-error></loading-error>
                            </td>
                        </tr>
                        <tr ng-if="transaction.operations.length === 0">
                            <td>
                                <loading-no-data text="'No operations found' | translate"></loading-no-data>
                            </td>
                        </tr>
                        <tr ng-if="transaction.operations !== 'error' && transaction.operations.length !== 0" data-ng-repeat="op in transaction.operations track by $index">
                            <td><div ng-bind-html="op.operation_text | to_trusted" layout-align="center"></div></td>
                            <td><a href='#/operations/{{op.operation_id}}/'>{{op.operation_id}}</a></td>
                            <td><span class="badge badge-primary" style="background-color: #{{op.op_color}};">{{op.op_type}}</span></td>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="panel panel-default">
                <div class="panel-heading"> <strong data-translate="Transaction Details"></strong></div>

                <div class="panel-body table-responsive">
                    <table class="table">
                        <tr>
                            <td><span data-translate="Hash"></span>:</td>
                            <td>{{transaction.data.hash}}</td>
                        </tr>
                        <tr>
                            <td><span data-translate="Block"></span>:</td>
                            <td><a href="#/blocks/{{transaction.data.block_num}}/">{{transaction.data.block_num | number}}</a></td>
                        </tr>
                        <tr>
                            <td><span data-translate="Date"></span>:</td>
                            <td>{{transaction.data.date}}</td>
                        </tr>
                        <tr>
                            <td><span data-translate="Operations in transaction"></span>:</td>
                            <td>{{(transaction.operations && transaction.operations.length || 0) | number}}</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>


    <div class="panel panel-default" ng-show="showRawData">
        <div class="panel-heading">
            <h3 class="panel-title"><span data-translate="Transactions raw data"></span></h3>
        </div>
        <div class="panel-body">
            <pre>{{data.transactions | json}}</pre>
        </div>
    </div>

</div>
